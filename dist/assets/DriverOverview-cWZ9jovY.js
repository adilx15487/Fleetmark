import{c as H,E as L,n as _,r as b,a2 as x,M as k,a3 as f,U as O,o as j,B as Y,j as e,P as $,t as h,a4 as v,a5 as N,a6 as G,L as F,I as z,J,a7 as V}from"./index-BOVp0MNk.js";import{u as W,S as C,c as S,E as q}from"./ErrorState-B3sflJ8u.js";import{T as K}from"./timer-BrZoRkXp.js";import{C as Q}from"./circle-check-BTsIrnxn.js";/**
 * @license lucide-react v0.574.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Z=H("power",X),T={new_passenger:{color:"text-sky-500",bg:"bg-sky-50"},cancellation:{color:"text-orange-500",bg:"bg-orange-50"},route_change:{color:"text-amber-500",bg:"bg-amber-50"},schedule_update:{color:"text-violet-500",bg:"bg-violet-50"},maintenance:{color:"text-red-500",bg:"bg-red-50"}},ee=()=>{const n=new Date().getHours();return n<12?"Good morning":n<17?"Good afternoon":"Good evening"},le=()=>{const{user:n}=L(),{generatedSlots:w,serviceStatus:r,config:o}=_(),{isLoading:I,isError:P,retry:D}=W(),[l,B]=b.useState(x.status==="on-duty"),[,M]=b.useState(0),R=V.slice(0,3);b.useEffect(()=>{const s=setInterval(()=>M(t=>t+1),3e4);return()=>clearInterval(s)},[]);const p=b.useMemo(()=>{const s=new Date,t=s.getHours()*60+s.getMinutes();return w.map(m=>{const[i,d]=m.time.split(":").map(Number),a=i*60+d;let c;if(m.status==="stopped")c="Break";else if(o.operatingHours.overnight){const u=t<720,y=a<720;u&&y||!u&&!y?c=a<t?"Completed":a<=t+30?"In Progress":"Upcoming":c=u?"Completed":"Upcoming"}else c=a<t-30?"Completed":a<=t+30?"In Progress":"Upcoming";return{slot:m,displayStatus:c}})},[w,o.operatingHours.overnight]),U=p.filter(s=>s.displayStatus!=="Break").length,g=p.filter(s=>s.displayStatus==="Break").length,A=[{...f.assignedRoute,icon:k,color:"text-primary-600",bg:"bg-primary-50"},{...f.passengersToday,icon:O,color:"text-accent-500",bg:"bg-sky-50"},{label:"Next Departure",value:r.state==="running"?r.nextDeparture:r.state==="break"?"On Break":"Offline",subtext:r.state==="running"?"Upcoming":r.state==="break"?`Resumes ${r.resumesAt}`:`Resumes ${r.resumesAt}`,icon:r.state==="break"?K:j,color:r.state==="running"?"text-emerald-500":r.state==="break"?"text-amber-500":"text-slate-400",bg:r.state==="running"?"bg-emerald-50":r.state==="break"?"bg-amber-50":"bg-slate-50"},{...f.busInfo,icon:Y,color:"text-violet-500",bg:"bg-violet-50"}],E={Completed:{text:"text-slate-500",bg:"bg-slate-50",border:"border-slate-200",icon:Q},"In Progress":{text:"text-emerald-600",bg:"bg-emerald-50",border:"border-emerald-200",icon:G},Upcoming:{text:"text-sky-600",bg:"bg-sky-50",border:"border-sky-200",icon:j}};return I?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-8",children:e.jsx(C,{})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4},(s,t)=>e.jsx(C,{},t))}),e.jsxs("div",{className:"grid lg:grid-cols-5 gap-6",children:[e.jsx(S,{className:"lg:col-span-3",items:5}),e.jsx(S,{className:"lg:col-span-2",items:3})]})]}):P?e.jsx(q,{onRetry:D}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`rounded-2xl p-6 sm:p-8 relative overflow-hidden transition-colors duration-300 ${l?"bg-gradient-to-br from-emerald-600 via-emerald-700 to-emerald-800":"bg-gradient-to-br from-slate-500 via-slate-600 to-slate-700"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-72 h-72 bg-white/5 rounded-full -translate-y-1/3 translate-x-1/3"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-40 h-40 bg-white/5 rounded-full translate-y-1/2 -translate-x-1/4"}),e.jsxs("div",{className:"relative z-10 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl sm:text-3xl font-bold text-white",children:[ee(),", ",(n==null?void 0:n.name.split(" ")[0])||"Driver"," ðŸ‘‹"]}),e.jsx("p",{className:"text-white/70 mt-1 text-sm sm:text-base",children:l?"You're on duty. Drive safe!":"You're currently off duty."}),l&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-4 text-sm text-white/80",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(j,{className:"w-3.5 h-3.5"}),x.startTime," â€” ",x.endTime]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"w-3.5 h-3.5"}),x.routeName]})]})]}),e.jsxs("button",{onClick:()=>B(!l),className:`inline-flex items-center gap-3 px-6 py-3 rounded-2xl text-sm font-bold transition-all active:scale-[0.97] shadow-lg shrink-0 ${l?"bg-white text-emerald-700 hover:bg-white/90 shadow-emerald-800/30":"bg-white text-slate-600 hover:bg-white/90 shadow-slate-700/30"}`,children:[e.jsx(Z,{className:"w-5 h-5"}),l?"ON DUTY":"OFF DUTY",e.jsx("span",{className:`w-3 h-3 rounded-full ${l?"bg-emerald-400 animate-pulse":"bg-slate-400"}`})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:A.map(s=>{const t=s.icon;return e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 hover:shadow-lg hover:shadow-primary-100/30 transition-shadow",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl ${s.bg} flex items-center justify-center mb-3`,children:e.jsx(t,{className:`w-5 h-5 ${s.color}`})}),e.jsx("p",{className:"text-2xl font-bold text-primary-900",children:s.value}),"subtext"in s&&s.subtext&&e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:s.subtext}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:s.label})]},s.label)})}),o.stoppedPeriods.length>0&&e.jsxs("div",{className:"flex items-center gap-3 px-5 py-3.5 rounded-2xl bg-amber-50 border border-amber-200",children:[e.jsx($,{className:"w-5 h-5 text-amber-500 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-amber-800",children:"Break Reminder"}),e.jsxs("p",{className:"text-xs text-amber-600",children:[o.stoppedPeriods.map(s=>`${h(s.startTime)} â†’ ${h(s.endTime)}`).join(", ")," â€” No service during break periods."]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-sm font-bold text-primary-900",children:["Your Route â€” ",v.totalStops," Stops"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[v.totalDistance," Â· ~",v.estimatedDuration]})]}),e.jsx("div",{className:"flex overflow-x-auto gap-0 pb-2",style:{scrollbarWidth:"thin"},children:e.jsx("div",{className:"flex items-start gap-0 min-w-max px-1",children:N.map((s,t)=>e.jsxs("div",{className:"flex items-start",children:[e.jsxs("div",{className:"flex flex-col items-center",style:{width:"80px"},children:[e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[9px] font-bold text-white shadow-sm ${t===0?"bg-primary-500":t===N.length-1?"bg-emerald-500":"bg-primary-300"}`,children:t+1}),e.jsx("p",{className:"text-[10px] font-medium text-primary-900 text-center mt-1 leading-tight px-0.5 max-w-[76px]",children:s.name}),e.jsxs("p",{className:"text-[9px] text-slate-400 mt-0.5",children:[s.passengerCount,"p"]})]}),t<N.length-1&&e.jsxs("div",{className:"flex items-center mt-[11px]",children:[e.jsx("div",{className:"w-5 h-[2px] bg-primary-200"}),e.jsx("div",{className:"w-0 h-0 border-t-[2px] border-t-transparent border-b-[2px] border-b-transparent border-l-[4px] border-l-primary-200"})]})]},t))})})]}),e.jsxs("div",{className:"grid lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-100",children:[e.jsx("h3",{className:"text-sm font-bold text-primary-900",children:"Today's Schedule"}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-400",children:[e.jsxs("span",{children:[U," trips"]}),g>0&&e.jsxs("span",{className:"text-amber-500",children:[g," break",g>1?"s":""]}),e.jsxs("span",{className:"text-slate-300",children:[h(o.operatingHours.startTime)," â€” ",h(o.operatingHours.endTime)]})]})]}),e.jsx("div",{className:"divide-y divide-slate-100 max-h-[460px] overflow-y-auto",children:p.map(({slot:s,displayStatus:t},m)=>{const i=t==="Break",d=i?{text:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200",icon:$}:E[t],a=d.icon;return e.jsxs("div",{className:`flex items-center gap-4 px-5 py-3.5 transition-colors ${i?"bg-amber-50/30":t==="In Progress"?"bg-emerald-50/40":"hover:bg-slate-50/50"}`,children:[e.jsx("div",{className:"flex flex-col items-center shrink-0",children:e.jsx("div",{className:`w-3 h-3 rounded-full border-2 ${i?"bg-amber-300 border-amber-400":t==="Completed"?"bg-slate-300 border-slate-300":t==="In Progress"?"bg-emerald-500 border-emerald-500 animate-pulse":"bg-white border-sky-400"}`})}),e.jsx("div",{className:"w-24 shrink-0",children:e.jsx("p",{className:`text-sm font-bold ${i?"text-amber-600":t==="Completed"?"text-slate-400":"text-primary-900"}`,children:s.label})}),e.jsx("div",{className:"flex-1 min-w-0",children:i?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-600",children:"Break Period"}),e.jsx("p",{className:"text-xs text-amber-400",children:s.reason||"Scheduled break"})]}):e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${t==="Completed"?"text-slate-400":"text-primary-800"}`,children:x.routeName}),e.jsxs("p",{className:"text-xs text-slate-400",children:[s.availableSeats,"/",s.totalSeats," seats available"]})]})}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-semibold border ${d.bg} ${d.text} ${d.border} shrink-0`,children:[e.jsx(a,{className:`w-3 h-3 ${t==="In Progress"?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:t})]})]},m)})})]}),e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-slate-100",children:[e.jsx("h3",{className:"text-sm font-bold text-primary-900",children:"Recent Notifications"}),e.jsxs(F,{to:"/driver/notifications",className:"text-xs font-semibold text-accent-500 hover:text-accent-600 transition-colors inline-flex items-center gap-1",children:["View All ",e.jsx(z,{className:"w-3 h-3"})]})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:R.map(s=>{const t=T[s.type]||T.new_passenger;return e.jsxs("div",{className:"flex items-start gap-3 px-5 py-4 hover:bg-slate-50/50 transition-colors",children:[e.jsx("div",{className:`w-9 h-9 rounded-xl ${t.bg} flex items-center justify-center shrink-0 mt-0.5`,children:e.jsx(J,{className:`w-4 h-4 ${t.color}`})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-primary-900 truncate",children:s.title}),!s.read&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-accent-500 shrink-0"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5 line-clamp-1",children:s.message}),e.jsx("p",{className:"text-[11px] text-slate-300 mt-1",children:s.time})]})]},s.id)})})]})]})]})};export{le as default};
