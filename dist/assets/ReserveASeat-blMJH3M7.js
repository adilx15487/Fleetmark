import{c as Z,u as ee,n as se,r as d,O as te,Q as C,j as e,o as D,t as O,i as ae,I as re,k as v,U as le,V as _,P as ne,T as R,B as F,H as ie,W as de}from"./index-RZfUFfFO.js";import{P as oe}from"./play-B2uRzWA6.js";/**
 * @license lucide-react v0.574.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Y=Z("check",ce),me=["Choose Route","Choose Seat & Time","Confirm"],he=()=>{const{toast:U}=ee(),{config:u,generatedSlots:B,serviceStatus:r}=se(),[h,b]=d.useState(1),[f,q]=d.useState(""),[Q,A]=d.useState(null),[$]=d.useState(()=>te()),[p,T]=d.useState(null),[n,y]=d.useState(null),[j,P]=d.useState(""),[w,I]=d.useState(!1),[M,o]=d.useState(""),[x,S]=d.useState(""),[g,N]=d.useState(""),l=C.find(s=>s.id===Q),V=d.useMemo(()=>{if(!l||!x)return[];const s=l.stops.indexOf(x);return s<0?[]:l.stops.slice(s+1)},[l,x]),E=d.useMemo(()=>f?C.filter(s=>s.status==="Active"&&s.name.toLowerCase().includes(f.toLowerCase())):C.filter(s=>s.status==="Active"),[f]),W=s=>{A(s),S(""),N("");const t=B.find(a=>a.status==="active");y(t||null),b(2)},z=s=>{const t=$.find(a=>a.id===s);t&&t.status==="available"&&(T(s),o(""))},G=()=>{if(!p&&!j&&!n){o("Please select a seat, time slot, and date to continue.");return}if(!n){o("Please select a departure time slot.");return}if(!x||!g){o("Please select your board at and drop off at stops.");return}if(!p){o("Please select a seat from the map.");return}if(!j){o("Please pick a date for your trip.");return}o(""),b(3)},J=()=>{I(!0),U("Seat confirmed! ðŸŽ‰")},K=()=>{b(1),A(null),T(null),y(null),P(""),S(""),N(""),I(!1)};return r.state,e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`rounded-2xl px-5 py-4 border ${r.state==="running"?"bg-emerald-50 border-emerald-200":r.state==="break"?"bg-amber-50 border-amber-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:`w-5 h-5 shrink-0 ${r.state==="running"?"text-emerald-600":r.state==="break"?"text-amber-600":"text-red-500"}`}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-700",children:["Operating hours: ",O(u.operatingHours.startTime)," â€” ",O(u.operatingHours.endTime),u.operatingHours.overnight&&e.jsx("span",{className:"text-slate-400 ml-1",children:"(overnight)"})]}),r.state==="running"&&e.jsxs("p",{className:"text-xs text-emerald-600",children:["Buses are running â€” Next departure at ",r.nextDeparture]}),r.state==="break"&&e.jsxs("p",{className:"text-xs text-amber-600",children:["Break time â€” Buses resume at ",r.resumesAt]}),r.state==="ended"&&e.jsxs("p",{className:"text-xs text-red-600",children:["Service ended â€” Resumes at ",r.resumesAt]})]})]}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${r.state==="running"?"bg-emerald-100 text-emerald-700":r.state==="break"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${r.state==="running"?"bg-emerald-500 animate-pulse":r.state==="break"?"bg-amber-500":"bg-red-500"}`}),r.state==="running"?"Running":r.state==="break"?"Break":"Offline"]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:e.jsx("div",{className:"flex items-center justify-between max-w-lg mx-auto",children:me.map((s,t)=>{const a=t+1,c=h===a,m=h>a||w;return e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold transition-all ${m?"bg-emerald-500 text-white":c?"bg-primary-600 text-white shadow-lg shadow-primary-600/20":"bg-slate-100 text-slate-400"}`,children:m?e.jsx(Y,{className:"w-4 h-4"}):a}),e.jsx("span",{className:`text-sm font-medium hidden sm:block ${c?"text-primary-900":"text-slate-400"}`,children:s})]}),t<2&&e.jsx("div",{className:`flex-1 h-px mx-2 ${h>a?"bg-emerald-300":"bg-slate-200"}`})]},s)})})}),h===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(ae,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search routesâ€¦",value:f,onChange:s=>q(s.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl border border-slate-200 text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all placeholder:text-slate-300"})]}),e.jsx("div",{className:"grid sm:grid-cols-2 xl:grid-cols-3 gap-4",children:E.map(s=>e.jsxs("button",{onClick:()=>W(s.id),className:"bg-white rounded-2xl border border-slate-200 p-5 text-left hover:shadow-lg hover:shadow-primary-100/30 hover:border-primary-300 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-bold text-primary-900 group-hover:text-primary-700",children:s.name}),e.jsx(re,{className:"w-4 h-4 text-slate-300 group-hover:text-primary-500 transition-colors shrink-0 mt-0.5"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-400 mb-3 flex-wrap",children:[s.stops.slice(0,3).map((t,a)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3 text-primary-400"}),e.jsx("span",{children:t}),a<2&&e.jsx("span",{className:"text-slate-300 mx-0.5",children:"â†’"})]},t+a)),s.stops.length>3&&e.jsxs("span",{className:"text-slate-300 ml-1",children:["â€¦ +",s.stops.length-3," more"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-slate-400 mb-1",children:[e.jsxs("span",{className:"font-semibold text-primary-600",children:[s.stops.length," stops"]}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:[s.stops[0]," â†’ ",s.stops[s.stops.length-1]]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 text-slate-400",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsxs("span",{children:["Every ",u.frequencyMinutes," min"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3 text-emerald-500"}),e.jsx("span",{className:"font-semibold text-emerald-600",children:s.availableSeats}),e.jsxs("span",{className:"text-slate-300",children:["/ ",s.totalSeats]})]})]})]},s.id))}),E.length===0&&e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-12 text-center text-sm text-slate-400",children:"No routes found matching your search."})]}),h===2&&l&&e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>b(1),className:"flex items-center gap-1.5 text-sm font-medium text-slate-500 hover:text-primary-600 transition-colors",children:[e.jsx(_,{className:"w-4 h-4"}),"Back"]}),e.jsx("h3",{className:"text-sm font-bold text-primary-900",children:l.name})]}),e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Select Departure Time"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 max-h-48 overflow-y-auto",children:B.map((s,t)=>{const a=(n==null?void 0:n.time)===s.time,c=s.status==="stopped",m=s.status==="active"&&s.availableSeats===0,k=c||m;return e.jsxs("button",{type:"button",disabled:k,onClick:()=>{y(s),o("")},className:`relative flex flex-col items-center gap-1 px-3 py-3 rounded-xl border text-sm transition-all ${a?"bg-primary-50 border-primary-400 ring-2 ring-primary-500/20 shadow-md":c?"bg-slate-50 border-slate-200 text-slate-400 cursor-not-allowed opacity-60":m?"bg-red-50 border-red-200 text-red-400 cursor-not-allowed":"bg-white border-slate-200 hover:border-primary-300 hover:shadow-sm cursor-pointer"}`,children:[c?e.jsx(ne,{className:"w-4 h-4 text-slate-300"}):m?e.jsx(R,{className:"w-4 h-4 text-red-400"}):e.jsx(oe,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{className:`font-bold text-xs ${a?"text-primary-900":c?"text-slate-400":"text-slate-700"}`,children:s.label}),c?e.jsx("span",{className:"text-[10px] text-slate-300",children:"Break"}):e.jsx("span",{className:`text-[10px] ${m?"text-red-400":"text-emerald-500"}`,children:m?"Full":`${s.availableSeats} seats`})]},t)})})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-5 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-5 h-5 rounded-md bg-emerald-100 border border-emerald-300"}),e.jsx("span",{className:"text-slate-500",children:"Available"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-5 h-5 rounded-md bg-red-100 border border-red-300"}),e.jsx("span",{className:"text-slate-500",children:"Reserved"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-5 h-5 rounded-md bg-primary-500 border border-primary-600"}),e.jsx("span",{className:"text-slate-500",children:"Your Pick"})]})]}),e.jsx("div",{className:"flex justify-center mb-3",children:e.jsxs("div",{className:"px-4 py-1.5 rounded-t-xl bg-slate-100 border border-b-0 border-slate-200 text-xs font-semibold text-slate-400 uppercase tracking-wider flex items-center gap-1.5",children:[e.jsx(F,{className:"w-3.5 h-3.5"})," Front"]})}),e.jsx("div",{className:"border border-slate-200 rounded-2xl p-4 max-w-xs mx-auto",children:e.jsx("div",{className:"grid grid-cols-[1fr_auto_1fr] gap-y-2",children:Array.from({length:12},(s,t)=>{const a=t+1,c=$.filter(i=>i.row===a),m=c.filter(i=>i.col==="A"||i.col==="B"),k=c.filter(i=>i.col==="C"||i.col==="D"),H=i=>{const X=p===i.id,L=i.status==="reserved";return e.jsx("button",{disabled:L,onClick:()=>z(i.id),className:`w-10 h-10 rounded-lg text-xs font-bold transition-all ${X?"bg-primary-500 text-white border-2 border-primary-600 shadow-md shadow-primary-500/30 scale-105":L?"bg-red-100 text-red-400 border border-red-200 cursor-not-allowed":"bg-emerald-50 text-emerald-700 border border-emerald-200 hover:bg-emerald-100 hover:border-emerald-400 hover:scale-105"}`,children:i.id},i.id)};return e.jsxs("div",{className:"contents",children:[e.jsx("div",{className:"flex gap-1.5 justify-end",children:m.map(H)}),e.jsx("div",{className:"w-6"}),e.jsx("div",{className:"flex gap-1.5",children:k.map(H)})]},a)})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5 space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold text-primary-900",children:"Trip Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1.5",children:"Departure Time"}),e.jsx("div",{className:`px-4 py-2.5 rounded-xl border text-sm font-medium ${n?"border-primary-300 bg-primary-50 text-primary-800":"border-slate-200 bg-slate-50 text-slate-400"}`,children:n?n.label:"Select a time slot above"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1.5",children:"Date"}),e.jsx("input",{type:"date",value:j,onChange:s=>{P(s.target.value),o("")},className:"w-full px-4 py-2.5 rounded-xl border border-slate-200 text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1.5",children:"Board at"}),e.jsxs("select",{value:x,onChange:s=>{S(s.target.value),N(""),o("")},className:"w-full px-4 py-2.5 rounded-xl border border-slate-200 text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none bg-white",children:[e.jsx("option",{value:"",children:"Select boarding stopâ€¦"}),l.stops.slice(0,-1).map((s,t)=>e.jsxs("option",{value:s,children:[t+1,". ",s]},`board-${t}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 mb-1.5",children:"Drop off at"}),e.jsxs("select",{value:g,onChange:s=>{N(s.target.value),o("")},disabled:!x,className:"w-full px-4 py-2.5 rounded-xl border border-slate-200 text-sm focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:x?"Select drop-off stopâ€¦":"Select boarding stop first"}),V.map((s,t)=>{const a=l.stops.indexOf(s);return e.jsxs("option",{value:s,children:[a+1,". ",s]},`drop-${t}`)})]})]})]}),e.jsxs("div",{className:"flex items-start gap-2 px-4 py-3 rounded-xl bg-amber-50 border border-amber-200",children:[e.jsx(R,{className:"w-4 h-4 text-amber-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[11px] text-amber-700 leading-relaxed",children:"Arrive at your stop on time. The bus will not wait. No pick-up or drop-off outside official stops."})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsx("h4",{className:"text-sm font-bold text-primary-900 mb-3",children:"Your Selection"}),p?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Seat"}),e.jsx("span",{className:"font-bold text-primary-900",children:p})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Route"}),e.jsx("span",{className:"font-medium text-primary-900",children:l.name.split(" â€” ")[0]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Board at"}),e.jsx("span",{className:"font-medium text-primary-900",children:x||"â€”"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Drop off"}),e.jsx("span",{className:"font-medium text-primary-900",children:g||"â€”"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-400",children:"Time"}),e.jsx("span",{className:"font-medium text-primary-900",children:(n==null?void 0:n.label)||"â€”"})]})]}):e.jsx("p",{className:"text-sm text-slate-300",children:"Select a seat from the map."}),e.jsx("button",{onClick:G,className:"w-full mt-4 px-5 py-3 rounded-xl bg-primary-600 text-white text-sm font-semibold hover:bg-primary-700 shadow-lg shadow-primary-600/20 transition-all disabled:opacity-40 disabled:cursor-not-allowed disabled:shadow-none",children:"Continue to Confirm"}),M&&e.jsx("p",{className:"mt-2 text-xs text-red-500 font-medium text-center",children:M})]})]})]}),h===3&&l&&!w&&e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("button",{onClick:()=>b(2),className:"flex items-center gap-1.5 text-sm font-medium text-slate-500 hover:text-primary-600 transition-colors mb-4",children:[e.jsx(_,{className:"w-4 h-4"}),"Back to seat map"]}),e.jsx("h3",{className:"text-lg font-bold text-primary-900 mb-5",children:"Reservation Summary"}),e.jsx("div",{className:"space-y-3 text-sm",children:[{label:"Route",value:l.name,icon:v},{label:"Board at",value:x,icon:v},{label:"Drop off at",value:g,icon:v},{label:"Bus",value:l.assignedBus,icon:F},{label:"Seat",value:p,icon:ie},{label:"Date",value:j,icon:de},{label:"Departure",value:(n==null?void 0:n.label)||"â€”",icon:D}].map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-slate-50",children:[e.jsx(s.icon,{className:"w-4 h-4 text-primary-500 shrink-0"}),e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx("span",{className:"text-slate-400",children:s.label}),e.jsx("span",{className:"font-semibold text-primary-900",children:s.value})]})]},s.label))}),e.jsxs("div",{className:"flex items-start gap-2 mt-4 px-3 py-2.5 rounded-xl bg-amber-50 border border-amber-200",children:[e.jsx(R,{className:"w-4 h-4 text-amber-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[11px] text-amber-700 leading-relaxed",children:"Arrive at your boarding stop on time. The bus will not wait beyond the scheduled departure."})]}),e.jsx("button",{onClick:J,className:"w-full mt-4 px-5 py-3.5 rounded-xl bg-emerald-500 text-white text-sm font-bold hover:bg-emerald-600 shadow-lg shadow-emerald-500/20 transition-all active:scale-[0.98]",children:"Confirm Reservation"})]})}),w&&e.jsx("div",{className:"max-w-lg mx-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(Y,{className:"w-8 h-8 text-emerald-500"})}),e.jsx("h3",{className:"text-xl font-bold text-primary-900 mb-2",children:"Seat Confirmed! ðŸŽ‰"}),e.jsxs("p",{className:"text-sm text-slate-400 mb-6",children:["Your reservation for seat ",e.jsx("span",{className:"font-bold text-primary-900",children:p})," on"," ",e.jsx("span",{className:"font-bold text-primary-900",children:l==null?void 0:l.name})," has been confirmed."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx("button",{onClick:K,className:"px-6 py-2.5 rounded-xl bg-primary-600 text-white text-sm font-semibold hover:bg-primary-700 transition-all",children:"Reserve Another"}),e.jsx("button",{className:"px-6 py-2.5 rounded-xl border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:"Add to Calendar"})]})]})})]})};export{he as default};
