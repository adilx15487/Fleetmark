import{Z as y,u as C,F as k,r as R,j as e,H as p,o as c,B as S,k as E,p as T,X as L,T as $}from"./index-BOVp0MNk.js";import{u as B,d as I,E as A}from"./ErrorState-B3sflJ8u.js";import{E as M}from"./EmptyState-CvP8QyBK.js";import{C as P}from"./check-BlTPTqQ1.js";const H=()=>{const{isLoading:b,isError:u,retry:j}=B(),x=y(),{toast:N}=C(),{tonightReservations:o,reservationsUsed:a,maxReservations:l,cancelReservation:f,pastReservations:m,getBusInfo:g,transport:v}=k(),[i,r]=R.useState(null),n=g(),d=o.filter(s=>s.status==="Confirmed"),h=o.filter(s=>s.status==="Cancelled"),w=()=>{i&&(f(i),N("Reservation cancelled.","warning"),r(null))};return b?e.jsx(I,{count:6,cols:"sm:grid-cols-2 xl:grid-cols-3"}):u?e.jsx(A,{onRetry:j}):v?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-primary-900",children:["Tonight's Reservations (",d.length,"/",l,")"]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[a," used"]})]}),e.jsx("div",{className:"w-full h-2.5 rounded-full bg-slate-100 mb-5",children:e.jsx("div",{className:`h-2.5 rounded-full transition-all ${a>=l?"bg-red-500":a>=l-1?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${a/l*100}%`}})}),d.length===0&&h.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(p,{className:"w-8 h-8 text-slate-200 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-slate-400",children:"No reservations yet tonight."}),e.jsx("button",{onClick:()=>x("/passenger/reserve"),className:"mt-3 px-5 py-2 rounded-xl bg-primary-600 text-white text-sm font-semibold hover:bg-primary-700 transition-all",children:"Reserve a Seat"})]}):e.jsxs("div",{className:"space-y-3",children:[d.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-emerald-50 border border-emerald-200",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center shrink-0",children:e.jsx(c,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-bold text-emerald-900",children:s.slotLabel}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-[11px] text-emerald-600 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),n==null?void 0:n.busNumber]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"}),s.homeStop]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs("span",{className:"hidden sm:inline-flex items-center gap-1 px-2.5 py-1 rounded-lg text-[10px] font-bold bg-emerald-200 text-emerald-800",children:[e.jsx(P,{className:"w-3 h-3"}),"Confirmed"]}),e.jsx("button",{onClick:()=>r(s.id),className:"p-2 rounded-xl text-red-400 hover:text-red-600 hover:bg-red-50 transition-all",title:"Cancel",children:e.jsx(T,{className:"w-4 h-4"})})]})]},s.id)),h.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200 opacity-60",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center shrink-0",children:e.jsx(c,{className:"w-5 h-5 text-slate-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-slate-500 line-through",children:s.slotLabel}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-0.5",children:s.homeStop})]}),e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-[10px] font-bold bg-slate-200 text-slate-500 shrink-0",children:"Cancelled"})]},s.id))]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b border-slate-100",children:e.jsx("h3",{className:"text-sm font-bold text-primary-900",children:"Past Nights"})}),m.length===0?e.jsx("div",{className:"p-8 text-center text-sm text-slate-300",children:"No past reservations."}):e.jsx("div",{className:"divide-y divide-slate-100",children:m.map(s=>e.jsxs("div",{className:"px-5 py-4",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3",children:s.date}),e.jsx("div",{className:"space-y-2",children:s.reservations.map(t=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(c,{className:`w-4 h-4 shrink-0 ${t.status==="Confirmed"?"text-emerald-500":"text-slate-300"}`}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:`text-sm font-medium ${t.status==="Confirmed"?"text-primary-900":"text-slate-400 line-through"}`,children:t.slotLabel}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:[t.homeStop," Â· ",t.busAssignment]})]})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold shrink-0 ${t.status==="Confirmed"?"bg-emerald-50 text-emerald-600 border border-emerald-200":"bg-slate-50 text-slate-400 border border-slate-200"}`,children:t.status})]},t.id))})]},s.date))})]}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 animate-page-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base font-bold text-primary-900",children:"Cancel this reservation?"}),e.jsx("button",{onClick:()=>r(null),className:"text-slate-400 hover:text-slate-600",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-start gap-2.5 p-3 rounded-xl bg-amber-50 border border-amber-200 mb-5",children:[e.jsx($,{className:"w-4 h-4 text-amber-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-amber-700",children:"Cancelling will free up this slot. Your usage counter will be updated."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>r(null),className:"flex-1 px-4 py-3 rounded-xl border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50 transition-colors",children:"Keep It"}),e.jsx("button",{onClick:w,className:"flex-1 px-4 py-3 rounded-xl bg-red-500 text-white text-sm font-bold hover:bg-red-600 shadow-lg shadow-red-500/20 transition-all active:scale-[0.98]",children:"Cancel Reservation"})]})]})})]}):e.jsx(M,{icon:e.jsx(p,{className:"w-8 h-8 text-slate-300"}),title:"Set up your transport first",subtitle:"Reserve your first trip to complete setup!",action:{label:"Reserve a Seat",onClick:()=>x("/passenger/reserve")}})};export{H as default};
